<vis-slide-over-filter (resetClicked)="reset()"
                       (searchClicked)="filter()"
                       [formGroup]="filterForm"
                       [tags]="tags">
	<ng-container slot="content">
		<div class="space-y-4">
			<div class="relative sm:col-span-4">
				<label for="watercourse"
				       class="block text-sm font-medium text-gray-700">
					Waterloop
				</label>
				<div class="mt-1">
					<vis-searchable-select id="watercourse"
					                       passedId="watercourse"
					                       placeholder="Selecteer een waterloop"
					                       tabIndex="-1"
					                       formControlName="watercourse"
					                       (search)="getWatercourses($event)"
					                       [options]="watercourses">
					</vis-searchable-select>
				</div>
			</div>

			<div class="relative sm:col-span-4">
				<label for="lenticWaterbody"
				       class="block text-sm font-medium text-gray-700">
					Watervlak
				</label>
				<div class="mt-1">
					<vis-searchable-select id="lenticWaterbody"
					                       passedId="lenticWaterbody"
					                       placeholder="Selecteer een watervlak"
					                       tabIndex="-1"
					                       formControlName="lenticWaterbody"
					                       (search)="getLenticWaterbodies($event)"
					                       [options]="lenticWaterbodies">
					</vis-searchable-select>
				</div>
			</div>

			<div class="relative sm:col-span-4">
				<label for="municipality"
				       class="block text-sm font-medium text-gray-700">
					Gemeente
				</label>
				<div class="mt-1">
					<vis-searchable-select id="municipality"
					                       passedId="municipality"
					                       placeholder="Selecteer een gemeente"
					                       tabIndex="-1"
					                       formControlName="municipality"
					                       (search)="getMunicipalities($event)"
					                       [options]="municipalities">
					</vis-searchable-select>
				</div>
			</div>

			<div class="relative sm:col-span-4">
				<label for="basin"
				       class="block text-sm font-medium text-gray-700">
					Bekken
				</label>
				<div class="mt-1">
					<vis-searchable-select id="basin"
					                       passedId="basin"
					                       placeholder="Selecteer een bekken"
					                       tabIndex="-1"
					                       formControlName="basin"
					                       (search)="getBasins($event)"
					                       [options]="basins">
					</vis-searchable-select>
				</div>
			</div>

			<div>
				<label class="block text-sm font-medium text-gray-700"
				       for="period">
					Periode
				</label>
				<div class="mt-1">
					<vis-daterange formControlName="period"
					               id="period"></vis-daterange>
				</div>
			</div>

			<div class="relative sm:col-span-4">
				<label for="measuringPointNumber"
				       class="block text-sm font-medium text-gray-700">
					Meetplaatscode
				</label>
				<div class="mt-1">
					<vis-searchable-select id="measuringPointNumber"
					                       passedId="measuringPointNumber"
					                       placeholder="Selecteer een meetplaatscode"
					                       tabIndex="-1"
					                       formControlName="measuringPointNumber"
					                       (search)="getFishingPointCodes($event)"
					                       [options]="fishingPointCodes"
					                       [configuration]="fishingPointSearchableSelectConfig">
					</vis-searchable-select>
				</div>
			</div>

			<div class="relative">
				<label class="block text-sm font-medium text-gray-700"
				       for="methodGroup">
					Methode groep
				</label>
				<div class="mt-1">
					<select class="mt-1"
					        formControlName="methodGroup"
					        id="methodGroup">
						<option [ngValue]="null">Methode groep selecteren...</option>
						<option *ngFor="let methodGroup of methodGroups$ | async"
						        [value]="methodGroup.code">{{methodGroup.description}}</option>
					</select>
				</div>
			</div>

			<div class="relative">
				<label class="block text-sm font-medium text-gray-700"
				       for="method">
					Methode
				</label>
				<div class="mt-1">
					<select class="mt-1"
					        formControlName="method"
					        id="method">
						<option [ngValue]="null">Methode selecteren...</option>
						<option *ngFor="let method of methods$ | async"
						        [value]="method.code">{{'method.' + method.code | translate}}</option>
					</select>
				</div>
			</div>

			<div class="relative">
				<label class="block text-sm font-medium text-gray-700">
					Soort
				</label>
				<div class="mt-1">
					<vis-species-search (onSearch)="getSpecies($event)"
					                    [index]="species.length"
					                    [taxons]="species"
					                    class="flex-grow"></vis-species-search>

				</div>
			</div>

			<div class="relative">
				<label class="block text-sm font-medium text-gray-700"
				       for="status">
					Status
				</label>
				<div class="mt-1">
					<vis-multi-select [options]="statuses$ | async"
					                  formControlName="status"
					                  id="status"></vis-multi-select>
				</div>
			</div>
		</div>
	</ng-container>
</vis-slide-over-filter>

<div class="px-4 py-4 sm:px-0">
	<div class="hidden lg:block">
		<vis-table [pager]="pager">
			<thead>
				<tr>
					<th scope="col"
					    class="table-header-cell w-2/12">
						Datum
						<vis-table-sort sortField="occurrence"></vis-table-sort>
					</th>
					<th class="table-header-cell"
					    scope="col">
						Vispunt
						<vis-table-sort sortField="fishingPoint.code"
						                title="Sorteren op meetplaatscode"></vis-table-sort>
						<vis-table-sort sortField="fishingPoint.vha.watercourse"
						                class="ml-0.5"
						                title="Sorteren op waterloop"></vis-table-sort>
						<vis-table-sort sortField="fishingPoint.vha.basinName"
						                class="ml-0.5"
						                title="Sorteren op watervlak"></vis-table-sort>
					</th>
					<th scope="col"
					    class="table-header-cell w-2/12">
						Methode
						<vis-table-sort sortField="method"></vis-table-sort>
					</th>
					<th scope="col"
					    class="table-header-cell w-2/12">
						Gemeente
						<vis-table-sort sortField="fishingPoint.vha.municipality"></vis-table-sort>
					</th>
					<th scope="col"
					    class="table-header-cell w-1/12">
						<span class="sr-only">Status</span>
					</th>
					<th scope="col"
					    class="table-header-cell w-1/12">
						<span class="sr-only">Bewerken</span>
					</th>
				</tr>
			</thead>
			<tbody>
				<tr visRow>
					<td *ngIf="loading"
					    visCell
					    colspan="8">
						<vis-loading-spinner></vis-loading-spinner>
					</td>
				</tr>

				<tr *ngFor="let surveyEvent of surveyEvents$ | async; let index = index"
				    [rownumber]="index"
				    visRow>
					<td visCell>
						<a [routerLink]="['/projecten', surveyEvent.projectCode, 'waarnemingen', surveyEvent.surveyEventId]"
						   class="text-pink-600 hover:text-pink-900">
							{{ surveyEvent.occurrence | date:'dd/MM/yyyy'}}
						</a>
					</td>
					<td visCell>
						<div class="text-sm"><a [routerLink]="['/vispunten', surveyEvent.fishingPointCode]"
						                        class="text-pink-600 hover:text-pink-900">{{surveyEvent.fishingPointCode}}</a>
						</div>
						<div
								class="text-sm">{{surveyEvent.isLentic ? surveyEvent.lenticName : surveyEvent.watercourse}} {{surveyEvent.basin ? ' - ' + surveyEvent.basin : ''}}</div>
					</td>
					<td visCell>
						{{ 'method.' + surveyEvent.method | translate }}
					</td>
					<td visCell>
						{{surveyEvent.municipality}}
					</td>
					<td visCell>
						<vis-survey-event-status-pill [surveyEvent]="surveyEvent"></vis-survey-event-status-pill>
					</td>
					<td visCell
					    [actions]="true">
						<vis-dropdown-minimal>
							<button
									[routerLink]="['/projecten', surveyEvent.projectCode, 'waarnemingen', surveyEvent.surveyEventId]"
									class="w-full text-left text-gray-700 block px-4 py-2 text-sm"
									id="menu-item-0"
									role="menuitem"
									tabindex="-1">Detail
							</button>
							<button
									*ngIf="surveyEvent.canEdit && authService.hasRole(role.EditSurveyEvent) && surveyEvent.status !== 'DELETED'"
									[routerLink]="['/projecten', surveyEvent.projectCode, 'waarnemingen', surveyEvent.surveyEventId, 'bewerk']"
									class="w-full text-left text-gray-700 block px-4 py-2 text-sm"
									id="menu-item-1"
									role="menuitem"
									tabindex="-1">Bewerken
							</button>
							<button
									*ngIf="surveyEvent.canEdit
                                && authService.hasRole(role.CreateMeasurements)
                                && surveyEvent.status !== 'DELETED' && surveyEvent?.status !== 'VALID'"
									[routerLink]="['/projecten', surveyEvent.projectCode, 'waarnemingen', surveyEvent.surveyEventId, 'metingen', 'toevoegen']"
									class="w-full text-left text-gray-700 block px-4 py-2 text-sm"
									id="menu-item-2"
									role="menuitem"
									tabindex="-1">Metingen toevoegen
							</button>
						</vis-dropdown-minimal>
					</td>
				</tr>
			</tbody>
		</vis-table>
	</div>
</div>


<div class="bg-white shadow overflow-hidden sm:rounded-md lg:hidden">
	<ul class="divide-y divide-gray-200">
		<li *ngFor="let surveyEvent of surveyEvents$ | async">
			<a [routerLink]="['/projecten', projectCode, 'waarnemingen', surveyEvent.surveyEventId]"
			   class="block hover:bg-gray-50">
				<div class="px-4 py-4 sm:px-6">
					<div class="flex items-center justify-between">
						<p class="text-sm font-medium text-pink-600 truncate">
							{{ surveyEvent.occurrence | date:'dd/MM/yyyy'}}
						</p>
					</div>
					<div class="mt-2 sm:flex sm:justify-between">
						<div class="sm:flex">
							<p class="flex items-center text-sm text-gray-500">
								<svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"
								     fill="currentColor"
								     viewBox="0 0 20 20"
								     xmlns="http://www.w3.org/2000/svg">
									<path clip-rule="evenodd"
									      d="M9.243 3.03a1 1 0 01.727 1.213L9.53 6h2.94l.56-2.243a1 1 0 111.94.486L14.53 6H17a1 1 0 110 2h-2.97l-1 4H15a1 1 0 110 2h-2.47l-.56 2.242a1 1 0 11-1.94-.485L10.47 14H7.53l-.56 2.242a1 1 0 11-1.94-.485L5.47 14H3a1 1 0 110-2h2.97l1-4H5a1 1 0 110-2h2.47l.56-2.243a1 1 0 011.213-.727zM9.03 8l-1 4h2.938l1-4H9.031z"
									      fill-rule="evenodd"></path>
								</svg>
								Meetplaatscode {{surveyEvent.fishingPointCode}}
							</p>
							<p class="mt-2 flex items-center text-sm text-gray-500 sm:mt-0 sm:ml-6">
								<svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"
								     fill="currentColor"
								     viewBox="0 0 20 20"
								     xmlns="http://www.w3.org/2000/svg">
									<path
											d="M8 5a1 1 0 100 2h5.586l-1.293 1.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L13.586 5H8zM12 15a1 1 0 100-2H6.414l1.293-1.293a1 1 0 10-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L6.414 15H12z"></path>
								</svg>
								<span *ngIf="!surveyEvent.isLentic">Waterloop {{surveyEvent.watercourse}}</span>
								<span *ngIf="surveyEvent.isLentic">Watervlak {{surveyEvent.lenticName}}</span>
							</p>

							<p *ngIf="!surveyEvent.isLentic"
							   class="mt-2 flex items-center text-sm text-gray-500 sm:mt-0 sm:ml-6">
								<svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"
								     fill="currentColor"
								     viewBox="0 0 20 20"
								     xmlns="http://www.w3.org/2000/svg">
									<path
											d="M8 5a1 1 0 100 2h5.586l-1.293 1.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L13.586 5H8zM12 15a1 1 0 100-2H6.414l1.293-1.293a1 1 0 10-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L6.414 15H12z"></path>
								</svg>
								{{surveyEvent.basin}}
							</p>
						</div>
						<div class="mt-2 flex items-center text-sm text-gray-500 sm:mt-0">
							<svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"
							     fill="currentColor"
							     viewBox="0 0 20 20"
							     xmlns="http://www.w3.org/2000/svg">
								<path
										d="M5 4a1 1 0 00-2 0v7.268a2 2 0 000 3.464V16a1 1 0 102 0v-1.268a2 2 0 000-3.464V4zM11 4a1 1 0 10-2 0v1.268a2 2 0 000 3.464V16a1 1 0 102 0V8.732a2 2 0 000-3.464V4zM16 3a1 1 0 011 1v7.268a2 2 0 010 3.464V16a1 1 0 11-2 0v-1.268a2 2 0 010-3.464V4a1 1 0 011-1z"></path>
							</svg>
							<p>
								{{ 'method.' + surveyEvent.method | translate }}
							</p>
						</div>
					</div>
				</div>
			</a>
		</li>
		<vis-paging-async [pager]="pager"></vis-paging-async>
	</ul>
</div>

